"use strict";function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.WordCloud=WordCloud;var _react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),d3=_interopRequireWildcard(require("d3")),_d3Cloud=_interopRequireDefault(require("d3-cloud")),_excluded=["data"];function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!=key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj["default"]=obj,cache&&cache.set(obj,newObj),newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=_objectWithoutPropertiesLoose(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],0<=excluded.indexOf(key)||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}function WordCloud(props){var svgRef=_react["default"].useRef(null),handleLoad=function(){var data=props.data,attr=_objectWithoutProperties(props,_excluded);D3WordCloud(svgRef.current,data,attr)};return _react["default"].useEffect(function(){handleLoad()},[props]),_react["default"].createElement("svg",{ref:svgRef})}WordCloud.propTypes={data:_propTypes["default"].array.isRequired,getWord:_propTypes["default"].func,getSize:_propTypes["default"].func,width:_propTypes["default"].number,height:_propTypes["default"].number,marginLeft:_propTypes["default"].number,marginRight:_propTypes["default"].number,marginTop:_propTypes["default"].number,marginBottom:_propTypes["default"].number,wordSizeRange:_propTypes["default"].arrayOf(_propTypes["default"].number),wordSizeDomain:_propTypes["default"].arrayOf(_propTypes["default"].number),wordColorRange:_propTypes["default"].arrayOf(_propTypes["default"].string),wordColorDomain:_propTypes["default"].arrayOf(_propTypes["default"].number),rotate:_propTypes["default"].oneOfType([_propTypes["default"].number,_propTypes["default"].func]),padding:_propTypes["default"].oneOfType([_propTypes["default"].number,_propTypes["default"].func]),animationTime:_propTypes["default"].number,enableAnimation:_propTypes["default"].bool},WordCloud.defaultProps={getWord:function getWord(d){return d.text},getSize:function getSize(){return .3+Math.random()},width:600,height:300,marginTop:50,marginBottom:30,marginRight:50,marginLeft:40,wordSizeRange:[15,75],wordSizeDomain:[.5,2],wordColorRange:["#ace","#0f0"],wordColorDomain:[15,75],rotate:function rotate(){return 30*(~~(6*Math.random())-3)},padding:3,animationTime:1e3,enableAnimation:!0};function D3WordCloud(element,data,_ref){var getWord=_ref.getWord,getSize=_ref.getSize,width=_ref.width,height=_ref.height,marginTop=_ref.marginTop,marginBottom=_ref.marginBottom,marginRight=_ref.marginRight,marginLeft=_ref.marginLeft,wordSizeRange=_ref.wordSizeRange,wordSizeDomain=_ref.wordSizeDomain,wordColorRange=_ref.wordColorRange,wordColorDomain=_ref.wordColorDomain,rotate=_ref.rotate,padding=_ref.padding,animationTime=_ref.animationTime,enableAnimation=_ref.enableAnimation,svg=d3.select(element);svg.selectAll("g").remove(),svg.attr("width",width).attr("height",height).attr("viewbox",[0,0,width,height]).attr("overflow","visible").append("g").attr("transform","translate(\n      ".concat(marginLeft+(width-marginLeft-marginRight)/2,",\n      ").concat(marginTop+(height-marginTop-marginBottom)/2,")"));var wordsData=data.map(function(d){return{text:getWord(d),size:getSize(d)}}),wordScale=d3.scaleLinear().range(wordSizeRange).domain(wordSizeDomain),colorScale=d3.scaleLinear().range(wordColorRange).domain(wordColorDomain),layout=(0,_d3Cloud["default"])().size([width,height]).words(wordsData).rotate(rotate).padding(padding).fontSize(function(d){return wordScale(d.size)}).on("end",function(words){svg.select("g").append("g").selectAll("text").data(words).join("text").attr("font-size",function(d){return d.size}).style("font-family","Impact").attr("fill",function(d){return colorScale(d.size)}).attr("text-anchor","middle").attr("transform",function(d){return"translate(".concat(d.x,", ").concat(d.y,") rotate(").concat(d.rotate,")")}).text(function(d){return d.text})});layout.start(),enableAnimation&&function(){svg.selectAll("text").attr("opacity",0).transition().attr("opacity",1).duration(animationTime)}()}